# Reference: <https://postmarketos.org/devicepkg>
# Maintainer: JustSoup321 <brandonboese@protonmail.com>
# Co-Maintainer: Alper Nebi Yasak <alpernebiyasak@gmail.com>
pkgname=device-google-x64cros
pkgdesc="Google Chromebooks with x64 CPU"
pkgver=2
pkgrel=0
url="https://postmarketos.org"
license="MIT"
arch="x86_64"
options="!check !archcheck"
depends="
	alsa-ucm-conf
	depthcharge-tools
	postmarketos-base
	postmarketos-cros-common
	postmarketos-update-depthcharge-kernel
	sof-bin
	systemd-boot
	"
makedepends="devicepkg-dev"
subpackages="
	$pkgname-libva
	$pkgname-kernel-lts:kernel_lts
	$pkgname-kernel-edge:kernel_edge
	$pkgname-vulkan
	"
source="deviceinfo modules-initfs"

build() {
	devicepkg_build $startdir $pkgname
}

package() {
	devicepkg_package $startdir $pkgname
}

libva() {
	install_if="$pkgname libva"
	depends="intel-media-driver libva-intel-driver"
	mkdir "$subpkgdir"
}

kernel_edge() {
	pkgdesc="Alpine Edge kernel"
	depends="linux-edge"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

kernel_lts() {
	pkgdesc="Alpine LTS kernel"
	depends="linux-lts"
	devicepkg_subpackage_kernel $startdir $pkgname $subpkgname
}

vulkan() {
	install_if="$pkgname vulkan-loader"
	depends="mesa-vulkan-intel"
	mkdir "$subpkgdir"
}

sha512sums="
d7ffced5a9dcfaa6473966174f23ebcecade38def8c309dc8f7637b8f0de71a0ca1b6e8952dd09020ea1b1ee0a960b6a283bbe3cd20801ad6776abf9a813401d  deviceinfo
9606a2f61bfd9e0a2ea04fbe45e25093b702fd5b5cccf9f4f50768ee3b501251d8d3e1605485e5ec8f485b4bff7e44fe20d488f80736837654a9951391a97789  modules-initfs
"
